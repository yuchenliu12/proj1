This is file 1. Some changes. Enhancements to master. This finishes r3